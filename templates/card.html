<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ display_name }} | {{ org }}</title>

  <style>
    :root{
      /* Theme */
      --bg:#F5F6FA;                 /* soft silver background */
      --bg2:#E5E7EB;                /* light silver */
      --card:#FFFFFF;               /* card white */
      --line:#E5E7EB;               /* borders */
      --text:#2E2E2E;               /* charcoal */
      --muted:#6B7280;              /* muted grey */
      --primary:#C8A2C8;            /* lilac */
      --primary2:#E9D7EE;           /* pale lilac */
      --btn:#6A1B9A;                /* deep plum (complimentary) */
      --btnHover:#4A148C;           /* darker plum */
      --shadow:0 18px 45px rgba(17,24,39,0.10);
      --radius:18px;
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:linear-gradient(135deg,var(--bg),var(--bg2));
      color:var(--text);
      padding:20px;
    }

    .card{
      width:min(460px,100%);
      border-radius:var(--radius);
      background:var(--card);
      border:1px solid var(--line);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .top{
      padding:20px;
      border-bottom:1px solid var(--line);
      display:flex;
      gap:16px;
      align-items:center;
      background:linear-gradient(135deg, rgba(200,162,200,0.14), rgba(229,231,235,0.65));
    }

    .branding{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
      flex: 0 0 auto;
    }

    .logo{

      width:54px;
      height:54px;
      border-radius:16px;
      background:#fff;
      border:1px solid var(--line);
      display:grid;
      place-items:center;
      overflow:hidden;
      box-shadow:0 10px 20px rgba(17,24,39,0.07);
    }
    .logo img{width:100%;height:100%;object-fit:cover}

    .logo-lg{width:96px;height:96px;border-radius:22px;}

    /* Profile photo under logo */
    .profile-frame{
      width:118px;
      height:118px;
      border-radius:50%;
      padding:4px;
      background:linear-gradient(135deg,var(--primary),var(--bg2));
      box-shadow:0 12px 26px rgba(106,27,154,0.18);
    }
    .profile-frame img{
      width:100%;
      height:100%;
      border-radius:50%;
      object-fit:cover;
      border:3px solid #fff;
    }

    .headertext{flex:1; min-width:0}

    .company{
      font-size:12px;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .name{
      font-size:24px;
      font-weight:850;
      margin:6px 0 2px;
      letter-spacing:-0.02em;
      line-height:1.15;
    }

    .title{
      color:var(--muted);
      font-size:14px;
    }

    .section{ padding:20px; }

    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:12px 12px;
      margin-bottom:10px;
      border-radius:14px;
      background:linear-gradient(135deg, rgba(200,162,200,0.08), rgba(229,231,235,0.45));
      border:1px solid var(--line);
    }
    .row span{color:var(--muted);font-size:13px; flex:0 0 auto;}
    .row a{
      color:var(--text);
      text-decoration:none;
      font-weight:650;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 68%;
      text-align:right;
    }

    /* Buttons */
    .btn{
  width: 86%;
  max-width: 360px;
  margin-left: auto;
  margin-right: auto;

      display:block;
      text-align:center;
      padding:14px;
      margin-top:12px;
      border-radius:14px;
      text-decoration:none;
      font-weight:750;
      background:var(--btn);
      color:#fff;
      border:1px solid rgba(74,20,140,0.18);
      transition:.18s ease;
      cursor:pointer;
      user-select:none;
    }
    .btn:hover{
      background:var(--btnHover);
      transform:translateY(-2px);
    }

    .footer{
      padding:15px 20px 20px;
      border-top:1px solid var(--line);
      font-size:12px;
      color:var(--muted);
      text-align:center;
      background:linear-gradient(135deg, rgba(229,231,235,0.55), rgba(200,162,200,0.10));
    }

    /* Modals */
    .modal{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(17,24,39,0.55);
      backdrop-filter:blur(8px);
      z-index:999;
      padding:20px;
    }
    .modal-content{
      background:var(--card);
      border-radius:18px;
      max-width:860px;
      margin:auto;
      max-height:90vh;
      overflow:auto;
      border:1px solid var(--line);
      box-shadow:var(--shadow);
    }
    .modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:14px;
      padding:18px 20px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(135deg, rgba(200,162,200,0.16), rgba(229,231,235,0.70));
      position: sticky;
      top: 0;
      z-index: 2;
    }
    .modal-header h2{margin:0;font-size:18px}
    .modal-header button{
      background:transparent;
      border:0;
      font-size:28px;
      color:var(--text);
      cursor:pointer;
      line-height:1;
    }
    .modal-body{
      padding:20px;
      line-height:1.65;
      color:var(--text);
    }
    .modal-body h3{
      margin-top:20px;
      margin-bottom:8px;
      color:#3b3b3b;
    }

    /* Plans */
    .plan{
      background:linear-gradient(135deg, rgba(200,162,200,0.08), rgba(229,231,235,0.50));
      border:1px solid var(--line);
      border-radius:16px;
      padding:18px;
      margin-bottom:16px;
    }
    .plan h3{margin:0 0 6px;font-size:18px}
    .price{
      font-size:16px;
      font-weight:850;
      margin-bottom:10px;
      color:var(--btn);
    }
    .plan ul{padding-left:18px;margin:10px 0 14px}
    .plan li{margin-bottom:6px;color:#3b3b3b}

    .plan-btn{
      display:block;
      text-align:center;
      padding:12px;
      border-radius:12px;
      background:var(--btn);
      color:#fff;
      text-decoration:none;
      font-weight:800;
      transition:.18s ease;
    }
    .plan-btn:hover{
      background:var(--btnHover);
      transform:translateY(-2px);
    }

    .highlight{
      border:2px solid var(--primary);
      background:linear-gradient(135deg, rgba(200,162,200,0.14), rgba(233,215,238,0.30));
    }

    @media (max-width: 420px){
      .row a{ max-width: 58%; }
      .name{ font-size: 22px; }
      .profile-frame{ width:110px; height:110px; }
    }
  
    .divider-soft{
      height:1px;
      background: var(--line);
      margin: 16px 0;
      opacity: 0.8;
    }
    .note{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.6;
      margin-top: 10px;
    }

  
    .share-counter{
      margin-bottom:16px;
      padding:12px;
      border-radius:14px;
      background:rgba(200,162,200,0.15);
      text-align:center;
      font-size:14px;
      border:1px solid var(--line);
    }
  /* Premium v3 */
body{
  background: radial-gradient(1200px 600px at 20% 10%, rgba(200,162,200,0.35), transparent 60%),
              radial-gradient(900px 600px at 80% 15%, rgba(229,231,235,0.75), transparent 55%),
              linear-gradient(180deg, #F9FAFB, #EEF2F7);
  color: #1F2937;
}
.card{ box-shadow: 0 20px 55px rgba(17,24,39,0.12); }
.hero{ animation: heroFade 850ms ease-out both; }
@keyframes heroFade{ from{opacity:0; transform: translateY(10px);} to{opacity:1; transform: translateY(0);} }

/* Reveal on scroll */
.reveal{opacity:0; transform: translateY(12px); transition: all 700ms ease;}
.reveal.in{opacity:1; transform: translateY(0);}

/* NFC prompt */
.nfc-prompt{
  display:flex; gap:12px; align-items:center;
  padding:14px 14px;
  border:1px solid var(--line);
  border-radius:16px;
  background: rgba(255,255,255,0.72);
  backdrop-filter: blur(10px);
  box-shadow: 0 12px 30px rgba(17,24,39,0.06);
  margin: 0 0 16px 0;
}
.nfc-title{font-weight:900; letter-spacing:0.2px; font-size:14px;}
.nfc-sub{color: var(--muted); font-size:13px; line-height:1.35;}
.nfc-icon{position:relative; width:44px; height:44px; flex:0 0 44px;}
.nfc-icon .chip{
  position:absolute; inset:12px;
  border-radius:12px;
  background: linear-gradient(135deg, rgba(200,162,200,0.9), rgba(229,231,235,0.95));
  border: 1px solid rgba(106,27,154,0.18);
  box-shadow: 0 10px 20px rgba(17,24,39,0.10);
}
.nfc-icon .ring{
  position:absolute; inset:0;
  border-radius:999px;
  border:2px solid rgba(106,27,154,0.22);
  opacity:0;
  animation: nfcPulse 1.8s ease-out infinite;
}
.nfc-icon .r2{animation-delay: 0.35s;}
.nfc-icon .r3{animation-delay: 0.7s;}
@keyframes nfcPulse{
  0%{transform:scale(0.65); opacity:0.0;}
  30%{opacity:0.35;}
  100%{transform:scale(1.1); opacity:0.0;}
}

/* Sticky WhatsApp FAB */
.whatsapp-fab{
  position: fixed; right: 16px; bottom: 16px;
  width: 56px; height: 56px; border-radius: 999px;
  background: rgba(255,255,255,0.88);
  border: 1px solid rgba(106,27,154,0.18);
  box-shadow: 0 18px 45px rgba(17,24,39,0.18);
  display: grid; place-items: center;
  z-index: 9999; text-decoration: none;
  backdrop-filter: blur(10px);
}
.whatsapp-fab svg{width:28px; height:28px; fill: rgba(34,197,94,0.95);}
.whatsapp-fab .wa-dot{
  position:absolute; width:10px; height:10px; border-radius:999px;
  background: rgba(34,197,94,0.95);
  top: 10px; right: 10px;
  box-shadow: 0 0 0 0 rgba(34,197,94,0.50);
  animation: waPing 1.6s ease-out infinite;
}
@keyframes waPing{
  0%{box-shadow:0 0 0 0 rgba(34,197,94,0.45);}
  100%{box-shadow:0 0 0 14px rgba(34,197,94,0);}
}

/* Buttons: premium depth */
.btn{
  box-shadow: 0 10px 22px rgba(106,27,154,0.12);
  transition: transform 160ms ease, box-shadow 160ms ease, background 160ms ease;
}
.btn:hover{
  transform: translateY(-1px);
  box-shadow: 0 14px 28px rgba(106,27,154,0.16);
}

</style>
<!-- Microsoft Clarity (Heatmap Tracking)
     1) Create a project at https://clarity.microsoft.com
     2) Replace YOUR_CLARITY_ID below with your Clarity Project ID
-->
<script type="text/javascript">
(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/YOUR_CLARITY_ID";
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script");
</script>

</head>

<body>
  <div class="card">

    <div class="top">
  <div class="branding">
    <div class="logo logo-lg">
      <img src="{{ url_for('static', filename=logo_filename) }}" alt="Logo" onerror="this.remove();">
    </div>

    <div class="profile-frame">
      <img src="{{ url_for('static', filename=photo_filename) }}" alt="{{ display_name }}" onerror="this.remove();">
    </div>

    <div class="company">{{ org }}</div>
    <div class="name">{{ display_name }}</div>
    <div class="title">{{ title }}</div>
  </div>
</div>

<div class="section">
<div class="nfc-prompt reveal">
  <div class="nfc-icon" aria-hidden="true">
    <span class="ring r1"></span>
    <span class="ring r2"></span>
    <span class="ring r3"></span>
    <span class="chip"></span>
  </div>
  <div>
    <div class="nfc-title">Tap NFC Card</div>
    <div class="nfc-sub">Hold your phone near the card to open this profile instantly.</div>
  </div>
</div>


  <div class="share-counter">
    <strong>Contact Shared:</strong> {{ share_count }} times
  </div>


  <div class="row">
    <span>WhatsApp</span>
    <a href="{{ url_for('go_whatsapp', slug=slug) }}?to={{ whatsapp_e164 }}" target="_blank" rel="noopener">{{ whatsapp_display }}</a>
  </div>

  <div class="row">
    <span>Office</span>
    <a href="tel:+{{ office_e164 }}">{{ office_display }}</a>
  </div>

  <div class="row">
    <span>Email</span>
    <a href="{{ url_for('go_email', slug=slug) }}?to={{ email }}&subject=Enquiry%20from%20Website">{{ email }}</a>
  </div>

  <div class="row">
    <span>Website</span>
    <a href="{{ website_url }}" target="_blank" rel="noopener">{{ website_display }}</a>
  </div>

  <div class="row">
    <span>Address</span>
    <a href="{{ url_for('go_map', slug=slug) }}"
       target="_blank" rel="noopener">
      208 Weltevreden Road, Northcliff
    </a>
  </div>

<a class="btn" href="{{ url_for('vcard') }}">Save to Contacts</a>
      <a class="btn" href="mailto:{{ email }}?subject=Funeral%20Service%20Enquiry">Email Us</a>
      <a class="btn" href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20Wjm%2C%20I%20need%20assistance%20please."
         target="_blank" rel="noopener">WhatsApp</a>
      <a class="btn" href="https://www.google.com/maps/dir/?api=1&destination={{ maps_destination }}"
         target="_blank" rel="noopener">Get Directions</a>

      <a class="btn" onclick="openModal('cremationModal')">Cremations</a>
      <a class="btn" onclick="openModal('coverModal')">Single Family Cover</a>
      <a class="btn" onclick="openModal('familyModal')">Family Cover</a>

    </div>

    <div class="footer">
      {{ org }} • {{ address_display }}
    </div>
  </div>

  <!-- Cremation Modal -->
  <div id="cremationModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="cremationTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="cremationTitle">Cremation Services</h2>
        <button onclick="closeModal('cremationModal')" aria-label="Close">×</button>
      </div>
      <div class="modal-body">
<h3>Cremation</h3>
<p>
  Choosing cremation can be a personal decision, or one based on faith and tradition. It offers flexibility and can be
  arranged in a way that honours your loved one’s wishes—whether simple and private, or more formal with a service.
</p>

<div class="divider-soft"></div>

<h3>Options and arrangements</h3>
<ul>
  <li><strong>Direct (private) cremation</strong> with no service present—often the most cost-effective option.</li>
  <li><strong>Service with the coffin present</strong> at a church, chapel, or venue, followed by cremation.</li>
  <li>Optional elements such as a private viewing, a wake, and a memorial service (before or after cremation).</li>
</ul>

<p>
  Your consultant will manage the arrangements on your behalf and guide you through decisions such as the internment,
  scattering, or burial of the cremains in a niche, grave, or place of significance.
</p>

<div class="divider-soft"></div>

<h3>Attended cremation</h3>
<p>
  The casket is brought to the church, chapel, or venue for the service. Depending on the venue, a final viewing may be
  arranged before, during, or after the service.
</p>
<p>
  After the service, the casket is transferred to the crematorium for cremation (immediately or at an arranged time).
  The cremains are later returned to the family in an ash box or urn.
</p>

<div class="divider-soft"></div>

<h3>Unattended cremation</h3>
<p>
  The deceased is not present at any church, chapel, or memorial venue. A memorial service may still be held separately.
  Cremation takes place before or after the memorial service as arranged, and the cremains are returned to the family.
</p>

<div class="divider-soft"></div>

<p class="note">
  We take utmost care throughout the cremation process and comply with stringent legislation to ensure the family
  receives only the remains of their loved one. Martin’s Funeral strives to deliver respectful, professional, and
  innovative service to people of any religion, culture, or tradition.
</p>
</div>
    </div>
  </div>

  <!-- Single Funeral Cover Modal -->
  <div id="coverModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="singleCoverTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="singleCoverTitle">Single Funeral Cover</h2>
        <button onclick="closeModal('coverModal')" aria-label="Close">×</button>
      </div>
      <div class="modal-body">

        <div class="plan">
          <h3>SAPPHIRE</h3>
          <div class="price">R 110 P/M</div>
          <ul>
            <li>R15 000.00 Maximum Cover</li>
            <li>18 Minimum Age</li>
            <li>64 Maximum Age</li>
            <li>6 Months Waiting Period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20SAPPHIRE%20Single%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

        <div class="plan">
          <h3>RUBY</h3>
          <div class="price">R 145 P/M</div>
          <ul>
            <li>R20 000.00 Maximum Cover</li>
            <li>18 Minimum Age</li>
            <li>64 Maximum Age</li>
            <li>6 Months Waiting Period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20RUBY%20Single%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

        <div class="plan highlight">
          <h3>DIAMOND</h3>
          <div class="price">R 220 P/M</div>
          <ul>
            <li>R30 000.00 Maximum Cover</li>
            <li>18 Minimum Age</li>
            <li>64 Maximum Age</li>
            <li>6 Months Waiting Period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20DIAMOND%20Single%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

      </div>
    </div>
  </div>

  <!-- Family Funeral Cover Modal -->
  <div id="familyModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="familyCoverTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="familyCoverTitle">Family Funeral Cover</h2>
        <button onclick="closeModal('familyModal')" aria-label="Close">×</button>
      </div>

      <div class="modal-body">

        <div class="plan">
          <h3>SAPPHIRE</h3>
          <div class="price">R 155 P/M</div>
          <ul>
            <li>R15 000.00 Principle Insured (18–64 Years)</li>
            <li>R15 000.00 Spouse (18–64 Years)</li>
            <li>R15 000.00 Child (14–21 Years)</li>
            <li>R7 500.00 Child (6–13 Years)</li>
            <li>R3 750.00 Child (1–5 Years)</li>
            <li>R3 750.00 Child (0–11 Months)</li>
            <li>R3 750.00 Stillborn Child</li>
            <li>6 Months Waiting Period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20SAPPHIRE%20Family%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

        <div class="plan highlight">
          <h3>FAMILY +5</h3>
          <div class="price">R 225 P/M</div>
          <ul>
            <li>R20 000.00 Max cover</li>
            <li>18 Min age</li>
            <li>70 Max age</li>
            <li>6 months Waiting period</li>
            <li>12 months Suicide waiting period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20FAMILY%20%2B5%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

        <div class="plan">
          <h3>RUBY</h3>
          <div class="price">R 200 P/M</div>
          <ul>
            <li>R20 000.00 Principle Insured (18–64 Years)</li>
            <li>R20 000.00 Spouse (18–64 Years)</li>
            <li>R20 000.00 Child (14–21 Years)</li>
            <li>R10 000.00 Child (6–13 Years)</li>
            <li>R5 000.00 Child (1–5 Years)</li>
            <li>R5 000.00 Child (0–11 Months)</li>
            <li>R5 000.00 Stillborn Child</li>
            <li>6 Months Waiting Period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20RUBY%20Family%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

        <div class="plan highlight">
          <h3>FAMILY +9</h3>
          <div class="price">R 375 P/M</div>
          <ul>
            <li>R20 000.00 Max cover</li>
            <li>18 Min age</li>
            <li>70 Max age</li>
            <li>6 months Waiting period</li>
            <li>12 months Suicide waiting period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20FAMILY%20%2B9%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

        <div class="plan">
          <h3>DIAMOND</h3>
          <div class="price">R 260 P/M</div>
          <ul>
            <li>R30 000.00 Principle Insured (18–64 Years)</li>
            <li>R30 000.00 Spouse (18–64 Years)</li>
            <li>R30 000.00 Child (14–21 Years)</li>
            <li>R15 000.00 Child (6–13 Years)</li>
            <li>R7 500.00 Child (1–5 Years)</li>
            <li>R7 500.00 Child (0–11 Months)</li>
            <li>R7 500.00 Stillborn Child</li>
            <li>6 Months Waiting Period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20DIAMOND%20Family%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

        <div class="plan highlight">
          <h3>FAMILY +13</h3>
          <div class="price">R 525 P/M</div>
          <ul>
            <li>R20 000.00 Max cover</li>
            <li>18 Min age</li>
            <li>70 Max age</li>
            <li>6 months Waiting period</li>
            <li>12 months Suicide waiting period</li>
          </ul>
          <a class="plan-btn"
             href="https://wa.me/{{ whatsapp_e164 }}?text=Hi%20I%20am%20interested%20in%20the%20FAMILY%20%2B13%20Funeral%20Cover"
             target="_blank" rel="noopener">Contact on WhatsApp</a>
        </div>

      </div>
    </div>
  </div>

  <script>
    function openModal(id){
      const m = document.getElementById(id);
      if(!m) return;
      m.style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeModal(id){
      const m = document.getElementById(id);
      if(!m) return;
      m.style.display = 'none';
      document.body.style.overflow = '';
    }

    // Close on outside click
    window.addEventListener('click', function(e){
      const modals = ['cremationModal','coverModal','familyModal'];
      for (const id of modals){
        const m = document.getElementById(id);
        if (m && e.target === m){
          closeModal(id);
        }
      }
    });

    // Close on ESC
    window.addEventListener('keydown', function(e){
      if (e.key !== 'Escape') return;
      const modals = ['cremationModal','coverModal','familyModal'];
      for (const id of modals){
        const m = document.getElementById(id);
        if (m && m.style.display === 'block'){
          closeModal(id);
        }
      }
    });
  </script>
<!-- QR Code Modal -->
<div id="qrModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Scan to open this card</h2>
      <button onclick="closeQR()">×</button>
    </div>
    <div class="modal-body" style="text-align:center;">
      <p class="note" style="margin-top:0;">
        Use this QR code on print material, posters, or email signatures.
        Scanning opens your digital business card instantly.
      </p>
      <img src="{{ url_for('qr_png') }}" alt="QR Code" style="width:240px; height:240px; border-radius:16px; border:1px solid var(--line); background:#fff; padding:10px;">
      <div style="height:14px;"></div>
      <a class="btn" href="{{ url_for('qr_png') }}" target="_blank" rel="noopener">Open QR Image</a>
    </div>
  </div>
</div>

<script>
function openQR(){document.getElementById('qrModal').style.display='block';}
function closeQR(){document.getElementById('qrModal').style.display='none';}
</script>
<!-- Sticky WhatsApp Button -->
<a class="whatsapp-fab" href="{{ url_for('go_whatsapp', slug=slug) }}" aria-label="Chat on WhatsApp">
  <span class="wa-dot"></span>
  <svg viewBox="0 0 32 32" aria-hidden="true">
    <path d="M19.11 17.55c-.29-.14-1.69-.83-1.95-.92-.26-.1-.45-.14-.64.14-.19.29-.73.92-.89 1.11-.16.19-.33.21-.62.07-.29-.14-1.22-.45-2.33-1.44-.86-.77-1.44-1.72-1.61-2.01-.17-.29-.02-.45.13-.59.13-.13.29-.33.44-.49.15-.16.19-.26.29-.45.1-.19.05-.36-.02-.5-.07-.14-.64-1.55-.88-2.12-.23-.55-.46-.48-.64-.49h-.55c-.19 0-.5.07-.76.36-.26.29-1 1-1 2.44 0 1.44 1.02 2.83 1.16 3.03.14.19 2 3.05 4.84 4.27.68.29 1.21.46 1.63.59.68.22 1.3.19 1.79.12.55-.08 1.69-.69 1.93-1.36.24-.67.24-1.25.17-1.36-.07-.12-.26-.19-.55-.33zM16.02 27.2h-.01c-1.82 0-3.59-.49-5.13-1.42l-.37-.22-3.83 1 1.02-3.73-.24-.38c-1.02-1.62-1.56-3.49-1.56-5.41 0-5.6 4.56-10.16 10.16-10.16 2.71 0 5.26 1.06 7.17 2.98 1.92 1.92 2.98 4.47 2.98 7.18 0 5.6-4.56 10.16-10.18 10.16zm8.64-18.82A12.14 12.14 0 0 0 16.03 4.8C9.51 4.8 4.2 10.11 4.2 16.63c0 2.14.56 4.23 1.62 6.06L4.1 29l6.47-1.69a11.8 11.8 0 0 0 5.46 1.33h.01c6.52 0 11.83-5.31 11.83-11.83 0-3.16-1.23-6.13-3.21-8.43z"/>
  </svg>
</a>

<script>
  // Reveal on scroll
  (function(){
    const els = document.querySelectorAll('.reveal');
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target); }
      });
    }, {threshold: 0.12});
    els.forEach(el=>io.observe(el));
  })();

  // Native Web Share
  async function shareCard(){
        // Count share taps (server-side)
        try{ await fetch("{{ url_for('go_share', slug=slug) }}", {method:"GET", cache:"no-store"}); }catch(e){}
const url = window.location.href;
    const title = document.title || "Digital Card";
    try{
      if(navigator.share){
        await navigator.share({ title, url });
      }else if(navigator.clipboard){
        await navigator.clipboard.writeText(url);
        alert("Link copied. You can paste it into WhatsApp or SMS.");
      }else{
        prompt("Copy this link:", url);
      }
    }catch(e){
      // user cancelled
    }
  }
</script>

</body>
</html>
